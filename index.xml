<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>jason's ÂçöÂÆ¢</title><link>https://jasonrd.github.io/blog/</link><description>Recent content on jason's ÂçöÂÆ¢</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sat, 28 May 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://jasonrd.github.io/blog/index.xml" rel="self" type="application/rss+xml"/><item><title>Archives</title><link>https://jasonrd.github.io/blog/archives/</link><pubDate>Sat, 28 May 2022 00:00:00 +0000</pubDate><guid>https://jasonrd.github.io/blog/archives/</guid><description/></item><item><title>kubectl exec deepin</title><link>https://jasonrd.github.io/blog/p/kubernetes/</link><pubDate>Tue, 01 Mar 2022 00:00:00 +0000</pubDate><guid>https://jasonrd.github.io/blog/p/kubernetes/</guid><description>&lt;img src="https://jasonrd.github.io/blog/p/kubernetes/helena-hertz-wWZzXlDpMog-unsplash.jpg" alt="Featured image of post kubectl exec deepin" />&lt;h2 id="ÈóÆÈ¢òÁé∞Ë±°">ÈóÆÈ¢òÁé∞Ë±°&lt;/h2>
&lt;p>ÊúÄËøëÔºåÂú®Â∑•‰ΩúÊÉ≥Ë¶Å‰ΩøÁî® kubectl exec ËøõÂÖ•ÂÆπÂô®ÊéíÊü•ÈóÆÈ¢òÔºåÁªìÊûúËøîÂõû‰∏ãÈù¢ÂºÇÂ∏∏Ôºö&lt;/p>
&lt;p>&lt;img src="https://jasonrd.github.io/blog/blog/p/kubernetes/img/exec-failure.png"
width="2828"
height="158"
srcset="https://jasonrd.github.io/blog/blog/p/kubernetes/img/exec-failure_hufe0606b0bd44839a8e6bff7d797c72f2_189000_480x0_resize_box_3.png 480w, https://jasonrd.github.io/blog/blog/p/kubernetes/img/exec-failure_hufe0606b0bd44839a8e6bff7d797c72f2_189000_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="1789"
data-flex-basis="4295px"
>&lt;/p>
&lt;h2 id="ÊéíÊü•ËøáÁ®ã">ÊéíÊü•ËøáÁ®ã&lt;/h2>
&lt;p>Êàë‰ª¨Áü•ÈÅì kubectl exec ÁöÑÊâßË°åÈìæË∑ØÊòØ client -&amp;gt; kube-apiserver -&amp;gt; kubelet -&amp;gt; docker„ÄÇ&lt;/p>
&lt;p>ÁôªÂΩï Kubelet ÂÆø‰∏ªÊú∫Êü•Áúã kubelet ÈîôËØØÊó•ÂøóÔºåÂèëÁé∞ÊúâÁõ∏ÂêåÁöÑÈîôËØØ‰ø°ÊÅØÔºåËøôËØ¥ÊòéÊòØ kubelet Âíå docker ‰πãÈó¥ÈìæË∑ØÂèàÈóÆÈ¢ò„ÄÇÈÄöËøá kubelet Êó•Âøó‰∏≠‰∏çËÉΩÂÆö‰∏∫Âà∞ÈóÆÈ¢òÂÖ∑‰ΩìÂéüÂõ†„ÄÇÁÑ∂ÂêéÔºåÊàë‰ª¨ËØïÂõæÈÄöËøáÊäìÂåÖÂèëÁé∞ÊòØÂê¶ÊúâÈîôËØØ‰ø°ÊÅØÂú® response ‰∏≠ËøîÂõû„ÄÇ&lt;/p>
&lt;p>Âú®ÊäìÂåÖÊï∞ÊçÆ‰∏≠ÊêúÁ¥¢ÂÖ≥ÈîÆÂ≠óÊú™ exec ÁöÑËØ∑Ê±ÇÔºåÂèëÁé∞Âè™Êúâ‰∏ÄÊù°Ôºà apiserver-&amp;gt;kubelet exec ËØ∑Ê±Ç‰∏∫ httpsÔºâ„ÄÇ‰ΩÜÊòØÔºå‰ªîÁªÜÊü•ÁúãËØ•ÁõÆÁöÑÂú∞ÂùÄ‰∏∫ A:20880, http header ‰∏≠ Host ‰∏∫ B:10250 Ôºà‰πüÂ∞±ÊòØÊòØÁâ©ÁêÜÊú∫‰∏ä kubelet ÁöÑ httpserver Âú∞ÂùÄÔºâ„ÄÇÊàë‰ª¨Êü•ËØ¢ A Ëøô‰∏™IPÔºåÂèëÁé∞ÊòØ‰∏öÂä°Â∫îÁî®ÁöÑÂÆπÂô® IP„ÄÇ&lt;/p>
&lt;p>ËøôÂ∞±ÊØîËæÉÂ•áÊÄ™‰∫ÜÔºåÊ≠£Â∏∏ apiserver ÂèëÈÄÅ exec ËØ∑Ê±Ç‰∏∫‰ªÄ‰πàËΩ¨ÂèëÂà∞‰∫ÜÂÆπÂô®ÁöÑ 20880 Á´ØÂè£„ÄÇËÄåÊàë‰ª¨‰∏∫‰∫ÜÊéíÊü•ÈóÆÈ¢òÔºåÂè™Âú®ËØ•Êú∫Âô®‰∏äÈÉ®ÁΩ≤‰∫Ü‰∏Ä‰∏™ÊµãËØïÂÆπÂô®ÔºåËØ•ÊµãËØïÂÆπÂô®Âπ∂‰∏ç‰ºöÂØπÂÆπÂô®Â§ñÂèëÈÄÅ‰ªª‰ΩïËØ∑Ê±Ç„ÄÇÂè¶Â§ñÊäìÂåÖ‰∏≠ http ËØ∑Ê±Ç header ‰πüÊòØ kubectl (&amp;ldquo;User-Agent: kubectl&amp;rdquo;)ÔºåÂèØ‰ª•ÁåúÊµãÂèëÈÄÅÂà∞ docker ÁöÑËØ∑Ê±ÇÔºàxxxx/exec/tokenÔºâË¢´ËΩ¨ÂèëÂà∞‰∫ÜÂÆπÂô®„ÄÇÈÄöËøáÂ§öÊ¨°Â∞ùËØïÊâßË°å kubectl exec Âπ∂ÊäìÂåÖÔºåÂèëÁé∞ÊâßË°åÂëΩ‰ª§ÂíåÂèëÈÄÅÂà∞ 20880 Á´ØÂè£ËØ∑Ê±ÇÂåπÈÖçÔºåËøôÈ™åËØÅ‰∫ÜÊàë‰ª¨ÁöÑÁåúÊµã„ÄÇ&lt;/p>
&lt;p>Âà∞Ê≠§Â∞±ÊääÈóÆÈ¢òËåÉÂõ¥Áº©Â∞èÂà∞ÂÆø‰∏ªÊú∫ÁΩëÁªú‰∏äÔºåÊàë‰ª¨Áü•ÈÅìÂΩì kube-proxy ‰ºöÈÄöËøá ipvs Êàñ iptables ÂØπÂàõÂª∫ÁöÑ nodeport Êàñ service vip ÁöÑËØ∑Ê±ÇËøõË°åÊã¶Êà™ÂíåËΩ¨Âèë„ÄÇÊàë‰ª¨Êü•Áúã conntrack ËØ∑Ê±ÇËÆ∞ÂΩïÔºö&lt;/p>
&lt;p>&lt;img src="https://jasonrd.github.io/blog/blog/p/kubernetes/img/exec-conntrack.png"
width="2706"
height="64"
srcset="https://jasonrd.github.io/blog/blog/p/kubernetes/img/exec-conntrack_huca2d8b10dc5e6cf266293d7184a5d6ec_84921_480x0_resize_box_3.png 480w, https://jasonrd.github.io/blog/blog/p/kubernetes/img/exec-conntrack_huca2d8b10dc5e6cf266293d7184a5d6ec_84921_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="4228"
data-flex-basis="10147px"
>&lt;/p>
&lt;p>ÂèëÁé∞‰∏ÄÊù°ËØ∑Ê±Ç 127.0.0.1:33589 ÁöÑËÆ∞ÂΩïÔºåÂπ∂‰∏îËΩ¨ÂèëÂà∞ÁöÑÂú∞ÂùÄ A:20880 ‰πüÂíåÊàë‰ª¨ÊäìÂåÖÁöÑÁªìÊûúÂåπÈÖç„ÄÇÁÑ∂ÂêéÊü•Áúã 33589 Á´ØÂè£ÔºåÂèëÁé∞ËØ•Á´ØÂè£Â∞±ÊòØË¢´ kubelet Âç†Áî®„ÄÇÁÑ∂ÂêéÔºåÊàë‰ª¨Êü•ËØ¢ serviceÔºåÂèëÁé∞ 33589 Á´ØÂè£ÂêåÊó∂ÊòØ B ÂÆπÂô®ÁöÑÂ∫îÁî® service ÁöÑ nodeport„ÄÇÂà∞Ê≠§ÈóÆÈ¢òÊ†πÊú¨ÂéüÂõ†ÂÆö‰ΩçÂà∞‰∫ÜÔºånodeport Á´ØÂè£Âíå kubelet Á´ØÂè£ÂÜ≤Á™ÅÔºåÂØºËá¥ÂèëÈÄÅ exec ËØ∑Ê±ÇËΩ¨ÂèëÂà∞‰∫ÜÂ∫îÁî®ÂÆπÂô®ÁöÑ 20880 Á´ØÂè£ÔºàdubboÁ´ØÂè£Ôºâ„ÄÇ&lt;/p>
&lt;h2 id="ÁªßÁª≠Ê∑±Êåñ">ÁªßÁª≠Ê∑±Êåñ&lt;/h2>
&lt;p>‰∫ãÊÉÖÂà∞Ê≠§Âπ∂Ê≤°ÊúâÁªìÊùüÔºå‰∏äÈù¢Êàë‰ª¨Âè™ÊòØÂÆö‰∏∫Âà∞‰∫ÜÂÖ∑‰ΩìÈóÆÈ¢òÂéüÂõ†„ÄÇÂÖ∂ÂÆûËøòÂ≠òÂú®‰∏§‰∏™ÈóÆÈ¢òÔºö&lt;/p>
&lt;ol>
&lt;li>ÂØπ kubectl exec ÁöÑÊâßË°åËøáÁ®ãËøòË°åÁªßÁª≠Êé¢Á©∂Ôºõ&lt;/li>
&lt;li>Â¶Ç‰ΩïÈÅøÂÖçËØ•ÈóÆÈ¢òÔºü&lt;/li>
&lt;/ol>
&lt;h3 id="kubectl-exec-ÁöÑÊâßË°åËøáÁ®ã">kubectl exec ÁöÑÊâßË°åËøáÁ®ã&lt;/h3>
&lt;p>ÈóÆÈ¢òÊ≤°ÊúâÂø´ÈÄüÂÆö‰ΩçÔºå‰∏ªË¶ÅÂéüÂõ†ËøòÊòØÂØπ kubectl exec ÊâßË°åÊµÅÁ®ã‰∏çÁÜü„ÄÇ‰∏ãÈù¢ÔºåÈÄöËøáÊ∫êÁ†ÅÊù•‰∫ÜËß£‰∏Ä‰∏ã kubectl ÊòØÊÄé‰πàÊâßË°åÁöÑ„ÄÇ&lt;/p>
&lt;p>Êú¨ÊñáÂü∫‰∫é 1.14.6 Ê∫êÁ†ÅËøõË°åÁ†îÁ©∂„ÄÇ&lt;/p>
&lt;p>È¶ñÂÖàÔºåÁÆÄÂçï‰∫ÜËß£‰∏Ä‰∏ã kubelet Êû∂ÊûÑÔºö&lt;/p>
&lt;p>&lt;img src="https://jasonrd.github.io/blog/blog/p/kubernetes/img/kubelet-arch.png"
width="1576"
height="368"
srcset="https://jasonrd.github.io/blog/blog/p/kubernetes/img/kubelet-arch_hu6568dec694f664b38c0d8a13d58d2338_47592_480x0_resize_box_3.png 480w, https://jasonrd.github.io/blog/blog/p/kubernetes/img/kubelet-arch_hu6568dec694f664b38c0d8a13d58d2338_47592_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="428"
data-flex-basis="1027px"
>&lt;/p>
&lt;p>kubelet ‰∏≠Êúâ‰∏äÈù¢Âá†‰∏™ÈÉ®ÂàÜÔºöcontainer manager„ÄÅdockershim„ÄÅhttp server„ÄÅstreaming server„ÄÇkubelet Êó©ÊúüÁõ¥Êé•Ë∞ÉÁî® docker api ÁÆ°ÁêÜÂÆπÂô®ÔºåÂêéÊù•‰∏∫‰∫ÜÈÄÇÈÖçÊõ¥Â§öÁöÑ runtime ÊäΩË±°Âá∫‰∫Ü‰∏Ä‰∏™Êé•ÂÖ•Â±Ç cri„ÄÇÂêåÊó∂Ôºå‰∏∫‰∫ÜÂÖºÂÆπ docker ÁöÑ APIÔºåkubelet ‰ª£Á†Å‰∏≠ÂÆûÁé∞‰∫ÜËøô‰∏™Âè´ dockershim ÁöÑÈÉ®ÂàÜ„ÄÇËøôÊ†∑Â∞±ÂØπ‰∏äÂ±ÇÂ±èËîΩ‰∫ÜÂ∫ïÂ±Ç runtime„ÄÇhttp server ÈÄöÂ∏∏‰ΩøÁî® 10250 ÂØπÂ§ñÊö¥Âäõ API ÊúçÂä°„ÄÇstreaming server ÊòØÈúÄË¶ÅÂíåÂÆπÂô®ËøõË°å‰∫§‰∫íÊó∂ÁöÑ‰∏Ä‰∏™‰ª£ÁêÜÊúçÂä°„ÄÇ&lt;/p>
&lt;p>Âú®ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÁî®Êà∑ÊâßË°å kubectl exec ÊµÅÁ®ãÔºö&lt;/p>
&lt;p>&lt;img src="https://jasonrd.github.io/blog/blog/p/kubernetes/img/kubelet-streamer.png"
width="1494"
height="1000"
srcset="https://jasonrd.github.io/blog/blog/p/kubernetes/img/kubelet-streamer_hu77ee1ab196b176433e041293050f2664_131743_480x0_resize_box_3.png 480w, https://jasonrd.github.io/blog/blog/p/kubernetes/img/kubelet-streamer_hu77ee1ab196b176433e041293050f2664_131743_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="149"
data-flex-basis="358px"
>&lt;/p>
&lt;ol>
&lt;li>terminal ‰∏≠ÈîÆÂÖ• kubectl exec xxx Êåá‰ª§Ôºåkubectl ÂèëÈÄÅËØ∑Ê±ÇÂà∞ apiserver https://apiserver/api/v1/namespaces/{ns}/pods/{pod}/exec?command=bash&amp;amp;container=dragon-claw&amp;amp;stdin=true&amp;amp;stdout=true&amp;amp;tty=trueÔºõ&lt;/li>
&lt;li>apiserver Êé•Âà∞ËØ∑Ê±ÇÂêéÔºåÂ∞ÜËØ∑Ê±ÇËΩ¨ÂèëÂà∞ kubeletÔºå node:10250/api/v1/exec/{ns}/{podid}/{container}„ÄÇkubelet httpserver Êé•Êî∂Âà∞ËØ∑Ê±ÇÂêéÔºö
&lt;ul>
&lt;li>È¶ñÂÖàÔºåÂêë dockershim ÂèëËµ∑ getExec ËØ∑Ê±ÇÔºåËøîÂõû‰∏Ä‰∏™ÊµÅÂú∞ÂùÄ url Ôºàexec/{token}ÔºâÔºõ&lt;/li>
&lt;li>ÁÑ∂ÂêéÔºåkubelet ËØ∑Ê±Ç exec/xxxx url Âà∞ streaming serverÔºåstreaming server Êé•Êî∂Âà∞ËØ∑Ê±ÇÂêéÔºåresponse upgrade Â∞ÜËøûÊé•ÂçáÁ∫ßÊàê‰∏∫ spdy Êàñ ws ËøûÊé•Ôºõ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>kubelet Êî∂Âà∞ upgrade reponse ÂêéÔºåÂ∞ÜËØ• reponse Áõ¥Êé•ËøîÂõûÁªô apiserverÔºåÂà∞Ê≠§ apiserver -&amp;gt; kubelet -&amp;gt; streaming server -&amp;gt; docker ‰πãÈó¥ËøûÊé•Âª∫Á´ãÂÆåÊàêÔºõ&lt;/li>
&lt;li>Âà∞Ê≠§ÔºåÁî®Êà∑ÂèØ‰ª•Âú® terminal ‰∏≠ÈîÆÂÖ•ÂëΩ‰ª§Âú®ÂÆπÂô®‰∏≠ÊâßË°åÔºõ&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://jasonrd.github.io/blog/blog/p/kubernetes/img/exec-uml.jpg"
width="2536"
height="1506"
srcset="https://jasonrd.github.io/blog/blog/p/kubernetes/img/exec-uml_hu2f1e02e515e351c311ec896043222feb_281732_480x0_resize_q75_box.jpg 480w, https://jasonrd.github.io/blog/blog/p/kubernetes/img/exec-uml_hu2f1e02e515e351c311ec896043222feb_281732_1024x0_resize_q75_box.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="168"
data-flex-basis="404px"
>&lt;/p>
&lt;p>ÂÖ∂‰∏≠Ôºå streaming server ÊòØ kubelet Âíå docker ‰πãÈó¥ÁöÑ‰∏Ä‰∏™Ê°•Ê¢ÅÔºå‰ªñË¥üË¥£Â∞ÜËØ∑Ê±ÇËΩ¨ÂèëÁªô dockerÔºàÊàñËÄÖÂÖ∂‰ªñ runtimeÔºâ„ÄÇkubelet ËÆøÈóÆ streaming server ÁöÑÂú∞ÂùÄÂ∞±ÊòØ 127.0.0.1:{streaming sever port}ÔºåËÄåÊàë‰ª¨ÈÅáÂà∞ÈóÆÈ¢ò‰∏≠ÔºåÁ´ØÂè£ÂÜ≤Á™ÅÁöÑÂ∞±ÊòØ streaming server Á´ØÂè£Âíå nodeport ÂÜ≤Á™Å„ÄÇ&lt;/p>
&lt;p>Êàë‰ª¨Âú®Ê∫êÁ†ÅÁ†îÁ©∂ËøáÁ®ã‰∏≠ÂèëÁé∞ÂèÇÊï∞ &amp;ndash;redirect-container-streaming&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">func (s *Server) getExec(request *restful.Request, response *restful.Response) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> .... ÁúÅÁï•Ëã•Âπ≤‰ª£Á†Å....
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> url, err := s.host.GetExec(podFullName, params.podUID, params.containerName, params.cmd, *streamOpts)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> if err != nil {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> streaming.WriteError(err, response.ResponseWriter)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> return
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> if s.redirectContainerStreaming {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> http.Redirect(response.ResponseWriter, request.Request, url.String(), http.StatusFound)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> return
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxyStream(response.ResponseWriter, request.Request, url)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ËØ•ÂèÇÊï∞Â¶ÇÊûúÂºÄÂêØÂêé‰ºöÂπ∂‰∏ç‰ºöËøõË°å proxyStream„ÄÇËÄåÊòØÁõ¥Êé•Âêë apiserver ÂèëÈÄÅ 302 Ë∑≥ËΩ¨Ôºö&lt;/p>
&lt;p>&lt;img src="https://jasonrd.github.io/blog/blog/p/kubernetes/img/kubelet-nostreamer.png"
width="1508"
height="1000"
srcset="https://jasonrd.github.io/blog/blog/p/kubernetes/img/kubelet-nostreamer_hu45498cf6e0b95b67adcec0e537e81e4b_116430_480x0_resize_box_3.png 480w, https://jasonrd.github.io/blog/blog/p/kubernetes/img/kubelet-nostreamer_hu45498cf6e0b95b67adcec0e537e81e4b_116430_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="150"
data-flex-basis="361px"
>&lt;/p>
&lt;p>ËØ•ÂèÇÊï∞ËØ¥ÊòéÔºåÂ¶Ç‰∏ãÔºö&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">--redirect-container-streaming Enables container streaming redirect. If false, kubelet will proxy container streaming data between apiserver and container runtime; if true, kubelet will return an http redirect to apiserver, and apiserver will access container runtime directly. The proxy approach is more secure, but introduces some overhead. The redirect approach is more performant, but less secure because the connection between apiserver and container runtime may not be authenticated.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Âè¶Â§ñÔºåÂú® 1.18 ÁâàÊú¨‰∏≠Êàë‰ª¨ÂèëÁé∞ËØ•ÂèÇÊï∞Âç≥Â∞ÜÂ∫üÂºÉÔºåÁ§æÂå∫‰∏≠Â∑≤ÁªèÂú® kep &lt;a class="link" href="https://github.com/kubernetes/enhancements/tree/master/keps/sig-node/1558-streaming-proxy-redirects#dependence-on-apiserver-redirects" target="_blank" rel="noopener"
>Cleaning up container streaming requests
&lt;/a>‰∏≠ËøõË°å‰∫ÜËØ¶ÁªÜËØ¥ÊòéÂêéÁª≠‰∏ãÁ∫øËÆ°ÂàíÔºà1.18 ËøõË°åÊèêÂçá„ÄÅ1.20ÁâàÊú¨ËØ•ÂèÇÊï∞Â§±Êïà„ÄÅ1.22 ËØ•ÂèÇÊï∞Ë¢´Âà†Èô§Ôºâ„ÄÇ&lt;/p>
&lt;h3 id="Â¶Ç‰ΩïÈÅøÂÖçÁ´ØÂè£ÂÜ≤Á™Å">Â¶Ç‰ΩïÈÅøÂÖçÁ´ØÂè£ÂÜ≤Á™Å&lt;/h3>
&lt;p>ÈÄöËøáÊ∫êÁ†ÅÊàë‰ª¨‰∫ÜËß£‰∫ÜÊâßË°å kube exec ÁöÑÊµÅÁ®ãÔºåÈÄöËøáÂÖ≥Èó≠ streaming server ÂèØ‰ª•ÈÅøÂÖç streaming server Á´ØÂè£Âíå nodeport ÂÜ≤Á™Å„ÄÇ‰ΩÜÊòØËØ•ÊñπÊ°àÂè™ËÉΩÂú® 1.20 ÁâàÊú¨ÂâçÁöÑÈõÜÁæ§‰∏≠‰ΩøÁî®„ÄÇ&lt;/p>
&lt;p>Âè¶Â§ñÔºåËøõ‰∏ÄÊ≠•ÊÄùËÄÉÔºåÂ¶ÇÊûúÂÖ∂‰ªñËøõÁ®ã‰ΩøÁî®‰∫Ü‰∏Ä‰∏™ÈöèÊú∫Á´ØÂè£ÊòØÂê¶‰πü‰ºöÂá∫Áé∞ËØ•ÈóÆÈ¢òÂë¢Ôºü&lt;/p>
&lt;p>ËøòÊòØÊúâ‰∏ÄÂÆöÂÜ≤Á™ÅÊ¶ÇÁéáÁöÑÔºåÂú® &lt;a class="link" href="https://github.com/kubernetes/kubernetes/issues/85418" target="_blank" rel="noopener"
>#85418&lt;/a> issue ‰∏≠Â∞±Êúâ‰∫∫ÊèêÂá∫‰∫ÜËØ•ÈóÆÈ¢òÔºå‰ªéÁõ∏ÂÖ≥ËÆ®ËÆ∫‰∏≠Êé®ËçêËß£ÂÜ≥ÊñπÊ≥ïÊòØÈÄöËøáÂÆø‰∏ªÊú∫È¢ÑÁïôÁ´ØÂè£Ôºànet.ipv4.ip_local_port_rangeÔºâËß£ÂÜ≥„ÄÇk8s apiserver ÈªòËÆ§ÁöÑ nodeport Á´ØÂè£ËåÉÂõ¥‰∏∫ 30000-32767 ÔºàÈÄöËøá &amp;ndash;service-node-port-range ÂèÇÊï∞ÈÖçÁΩÆÔºâÔºå‰∏ÄËà¨ÂÆø‰∏ªÊú∫ net.ipv4.ip_local_port_range ÈªòËÆ§ËåÉÂõ¥‰∏∫ 32768-60999„ÄÇËÄåÊàë‰ª¨Âá∫Áé∞ÂÜ≤Á™ÅÔºåÂõ†‰∏∫‰ΩøÁî®ÁöÑÊüê‰∫ë k8s ÈõÜÁæ§‰øÆÊîπ‰∫Ü apiserver ÂèÇÊï∞‰∏∫ 30000-50000ÔºåÂØºËá¥Âá∫Áé∞Á´ØÂè£ÂÜ≤Á™ÅÈóÆÈ¢ò„ÄÇ&lt;/p>
&lt;p>ÂÖ∂ÂÆûÔºåkube-proxy ‰∏∫‰∫ÜÈÅøÂÖçÁ´ØÂè£ÂÜ≤Á™ÅÁöÑÈóÆÈ¢òÔºåËøêË°åËøáÁ®ã‰ºöÁõëÂê¨ÊâÄÊúâÁöÑ nodeport Á´ØÂè£„ÄÇ‰ΩÜÊòØÔºåËøôÂ≠òÂú®‰∏Ä‰∏™È∏°ÁîüËõãÁöÑÈóÆÈ¢ò„ÄÇÂ¶ÇÊûúÊüê‰∏™ nodeport ÂàÜÈÖçÂâçÂ∑≤ÁªèË¢´ÂÖ∂‰ªñÂ∫îÁî®Âç†Áî®ÔºåÊàñËÄÖ kube-proxy ÈáçÂêØÔºåËøòÊòØ‰ºöÂ≠òÂú®Á´ØÂè£ÂÜ≤Á™ÅÁöÑÈóÆÈ¢ò„ÄÇÂú® &lt;a class="link" href="https://github.com/kubernetes/kubernetes/issues/100643" target="_blank" rel="noopener"
>#100643&lt;/a> issue ‰∏≠‰πüËøõË°å‰∫ÜÁõ∏ÂÖ≥ËÆ®ËÆ∫ÔºåÂ∏åÊúõÂêéÁª≠ËÉΩÊúâÂÆåÁæéÁöÑËß£ÂÜ≥ÊñπÊ°à„ÄÇ&lt;/p>
&lt;p>Áªº‰∏äÔºåÁõÆÂâçËß£ÂÜ≥ÊñπÊ°à‰∏ãÈù¢Âá†ÁßçÔºö&lt;/p>
&lt;ol>
&lt;li>1.20 ÂâçÁâàÊú¨ÂèØ‰ª•ÈÄöËøá &amp;ndash;redirect-container-streaming ÂÖ≥Èó≠ steaming serverÔºåÈÅøÂÖç kubelet Âíå nodeport Á´ØÂè£ÂÜ≤Á™ÅÔºõ&lt;/li>
&lt;li>‰øÆÊîπÁ≥ªÁªüÂèÇÊï∞Âíå apiserver Á´ØÂè£ËåÉÂõ¥Ôºå‰øùËØÅÂíåÂÆø‰∏ªÊú∫ÈöèÊú∫Á´ØÂè£ËåÉÂõ¥‰∏çÈáçÂêàÔºõ&lt;/li>
&lt;li>ÂÖ∂‰ªñÊäÄÊúØÔºå‰æãÂ¶Ç &lt;a class="link" href="https://github.com/kubernetes/kubernetes/issues/100643" target="_blank" rel="noopener"
>#100643&lt;/a> issue ‰∏≠ÊèêÂá∫ÁöÑ ebpf„ÄÇ&lt;/li>
&lt;/ol></description></item><item><title>Links</title><link>https://jasonrd.github.io/blog/links/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://jasonrd.github.io/blog/links/</guid><description>&lt;p>To use this feature, add &lt;code>links&lt;/code> section to frontmatter.&lt;/p>
&lt;p>This page&amp;rsquo;s frontmatter:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">links&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">title&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">GitHub&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">description&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">GitHub is the world&amp;#39;s largest software development platform.&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">website&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">https://github.com&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">title&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TypeScript&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">description&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TypeScript is a typed superset of JavaScript that compiles to plain JavaScript.&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">website&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">https://www.typescriptlang.org&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ts-logo-128.jpg&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>image&lt;/code> field accepts both local and external images.&lt;/p></description></item><item><title>Search</title><link>https://jasonrd.github.io/blog/search/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://jasonrd.github.io/blog/search/</guid><description/></item><item><title>ÂÖ≥‰∫é</title><link>https://jasonrd.github.io/blog/%E5%85%B3%E4%BA%8E/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://jasonrd.github.io/blog/%E5%85%B3%E4%BA%8E/</guid><description>&lt;p>Ê¨¢ËøéÊù•Âà∞ÊàëÁöÑÂ∞èÂ±ãüõñ&lt;/p></description></item></channel></rss>